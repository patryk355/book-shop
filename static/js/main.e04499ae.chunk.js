(this["webpackJsonpbook-shop"]=this["webpackJsonpbook-shop"]||[]).push([[0],[,,,,,function(t,e,n){t.exports={closeBtn:"Cart_closeBtn__1ICZ_",header:"Cart_header__1VRmx","products-list":"Cart_products-list__OlyJ_",title:"Cart_title__Kwtc3",amount:"Cart_amount__29byP",price:"Cart_price__37oVf",actions:"Cart_actions__c-t0c",totalAmount:"Cart_totalAmount__1f3TY",totalPrice:"Cart_totalPrice__Gm-k2"}},,,function(t,e,n){t.exports={form:"Form_form__2y-Jr","form-input":"Form_form-input__CRMoT","form-controls":"Form_form-controls__nMuVF",invalid:"Form_invalid__3mKlT"}},,function(t,e,n){t.exports={book:"Book_book__3FjtB",details:"Book_details__2xTbb",description:"Book_description__3M4oY","price-container":"Book_price-container__1_zYK",price:"Book_price__38dEK"}},function(t,e,n){t.exports={header:"Header_header__2uZ4G",list:"Header_list__3nnki"}},function(t,e,n){t.exports={backdrop:"Modal_backdrop__20xkn",modal:"Modal_modal__3grQr",content:"Modal_content__3XRqP"}},function(t,e,n){t.exports={error:"Notification_error__1y0Yx",success:"Notification_success__Zcl8d",info:"Notification_info__3MbSH"}},,,function(t,e,n){t.exports={button:"CartButton_button__3P__5",amount:"CartButton_amount__pA_MC"}},,function(t,e,n){t.exports={button:"Button_button__17Z83"}},function(t,e,n){t.exports={books:"Books_books__AjOCc"}},,,,,function(t,e,n){},,,,,,,,,function(t,e,n){"use strict";n.r(e);var o=n(1),c=n.n(o),i=n(7),a=n.n(i),r=(n(24),n(2)),s=n(6),u=n(3),l=Object(u.b)({name:"cart",initialState:{items:[],totalAmount:0,totalPrice:0},reducers:{setTotalAmountAndPrice:function(t){var e=0,n=0;t.items.forEach((function(t){e+=t.amount,n+=t.amount*t.price})),t.totalAmount=e,t.totalAmount=n},fetchItems:function(t,e){t.items=e.payload.items,0===t.items.length?(t.totalAmount=0,t.totalPrice=0):(t.totalAmount=e.payload.totalAmount,t.totalPrice=e.payload.totalPrice)},addItemToCart:function(t,e){var n=e.payload,o=t.items.find((function(t){return t.id===n.id}));if(t.totalAmount++,t.totalPrice+=e.payload.price,o){var c=t.items.findIndex((function(t){return t.id===n.id}));t.items[c].amount+=1}else t.items.push({id:e.payload.id,title:e.payload.title,author:e.payload.author,price:e.payload.price,amount:e.payload.amount})},removeItemFromCart:function(t,e){var n=e.payload,o=t.items.find((function(t){return t.id===n.id}));if(t.totalAmount--,t.totalPrice-=e.payload.price,o){var c=t.items.findIndex((function(t){return t.id===n.id}));t.items[c].amount-=1,0===t.items[c].amount&&t.items.splice(c,1)}else t.items.push({id:e.payload.id,title:e.payload.title,author:e.payload.author,price:e.payload.price,amount:e.payload.amount})}}}),d=l.actions,m=l,j=Object(u.b)({name:"notification",initialState:{type:"",content:"",showNotification:!1},reducers:{showNotification:function(t,e){t.showNotification=!0,t.type=e.payload.type,t.content=e.payload.content},hideNotification:function(t){t.showNotification=!1,t.type="",t.content=""}}}),b=j.actions,f=j,h=n(18),p=n.n(h),O=n(0),x=function(t){return Object(O.jsx)("button",{type:t.type?t.type:"button",onClick:t.onClick,className:p.a.button,children:t.value})},_=n(12),v=n.n(_),y=function(t){return Object(O.jsx)("div",{className:v.a.backdrop,onClick:t.onClose})},w=function(t){return Object(O.jsx)("div",{className:v.a.modal,children:Object(O.jsx)("div",{className:v.a.content,children:t.children})})},g=document.getElementById("overlays"),k=function(t){return Object(O.jsxs)(o.Fragment,{children:[a.a.createPortal(Object(O.jsx)(y,{onClose:t.onClose}),g),a.a.createPortal(Object(O.jsx)(w,{children:t.children}),g)]})},N=n(10),C=n.n(N),P=function(t){var e=t.id,n=t.title,c=t.author,i=t.description,a=t.price,u=t.image_url,l=Object(r.b)(),m=Object(r.c)((function(t){return t.login.isLogged})),j=Object(o.useState)(!1),f=Object(s.a)(j,2),h=f[0],p=f[1],_=Object(o.useState)(!1),v=Object(s.a)(_,2),y=v[0],w=v[1];return Object(O.jsxs)(o.Fragment,{children:[!m&&y&&Object(O.jsx)(k,{children:"You need to login."}),Object(O.jsxs)("li",{className:C.a.book,children:[Object(O.jsx)("h2",{children:n}),Object(O.jsx)("h3",{children:c}),Object(O.jsxs)("div",{className:C.a.details,children:[Object(O.jsxs)("p",{className:C.a.description,children:[h?i:i.substr(0,100)+"...",Object(O.jsx)("button",{onClick:function(){p((function(t){return!t}))},children:h?"Read Less":"Read More"})]}),Object(O.jsx)("img",{src:u,alt:n})]}),Object(O.jsxs)("div",{className:C.a["price-container"],children:[Object(O.jsxs)("p",{className:C.a.price,children:[a,"$"]}),Object(O.jsx)(x,{value:"Add to cart",onClick:function(){m?(l(d.addItemToCart({id:e,title:n,author:c,price:a,amount:1})),l(b.showNotification({type:"success",content:"Successfully added book to cart!"}))):(w(!0),setTimeout((function(){w(!1)}),1e3))}})]})]})]})},T=n(19),A=n.n(T),S=function(){var t=Object(r.c)((function(t){return t.books.items}));return Object(O.jsx)("section",{className:A.a.books,children:Object(O.jsx)("ul",{children:t.map((function(t){var e=t.id,n=t.title,o=t.author,c=t.description,i=t.price,a=t.image_url;return Object(O.jsx)(P,{id:e,title:n,author:o,description:c,price:i,image_url:a},e)}))})})},F=Object(u.b)({name:"ui",initialState:{showForm:!1,showCart:!1},reducers:{toggleForm:function(t){t.showForm=!t.showForm},toggleCart:function(t){t.showCart=!t.showCart}}}),E=F.actions,B=F,V=n(5),I=n.n(V),M=function(){var t=Object(r.b)(),e=Object(r.c)((function(t){return t.cart})),n=function(){t(E.toggleCart())};return Object(O.jsxs)(k,{onClose:n,children:[Object(O.jsx)("button",{className:I.a.closeBtn,onClick:n,children:"X"}),Object(O.jsx)("h2",{className:I.a.header,children:"Your Cart"}),Object(O.jsx)("ul",{className:I.a["products-list"],children:e.items.map((function(e){var n=e.amount,o=e.author,c=e.id,i=e.price,a=e.title;return Object(O.jsxs)("li",{children:[Object(O.jsx)("h3",{className:I.a.title,children:a}),Object(O.jsxs)("div",{children:[Object(O.jsxs)("p",{className:I.a.price,children:[n*i,"$"]}),Object(O.jsxs)("div",{className:I.a.amount,children:[Object(O.jsx)("button",{className:I.a.actions,onClick:function(){return function(e,n,o,c,i){t(d.removeItemFromCart({id:e,title:n,author:o,price:c,amount:i})),t(b.showNotification({type:"success",content:"Successfully removed book from cart!"}))}(c,a,o,i,n)},children:"-"}),Object(O.jsx)("input",{type:"number",min:"0",value:n,readOnly:!0}),Object(O.jsx)("button",{className:I.a.actions,onClick:function(){return function(e,n,o,c,i){t(d.addItemToCart({id:e,title:n,author:o,price:c,amount:i})),t(b.showNotification({type:"success",content:"Successfully added book to cart!"}))}(c,a,o,i,n)},children:"+"})]})]})]},c)}))}),Object(O.jsxs)("h3",{className:I.a.totalAmount,children:["Total Amount: ",e.totalAmount]}),Object(O.jsxs)("h3",{className:I.a.totalPrice,children:["Total Price: ",e.totalPrice," $"]})]})},L=Object(u.b)({name:"login",initialState:{isLogged:!1},reducers:{login:function(t){t.isLogged=!0},logout:function(t){t.isLogged=!1}}}),Y=L.actions,J=L,R=Object(u.b)({name:"validation",initialState:{validEmail:null,validPassword:null,emailTouched:!1,passwordTouched:!1},reducers:{isEmailValid:function(t,e){t.validEmail=e.payload.isValid},isPasswordValid:function(t,e){t.validPassword=e.payload.isValid},isEmailTouched:function(t,e){t.emailTouched=e.payload.isTouched},isPasswordTouched:function(t,e){t.passwordTouched=e.payload.isTouched}}}),K=R.actions,Z=R,H=n(8),$=n.n(H),D=function(){var t=Object(r.b)(),e=Object(r.c)((function(t){return t.validation.validEmail})),n=Object(r.c)((function(t){return t.validation.validPassword})),c=Object(r.c)((function(t){return t.validation.emailTouched})),i=Object(r.c)((function(t){return t.validation.passwordTouched})),a=(Object(r.c)((function(t){return t.ui.showForm})),Object(o.useState)("")),u=Object(s.a)(a,2),l=u[0],d=u[1],m=Object(o.useState)(""),j=Object(s.a)(m,2),b=j[0],f=j[1];c&&!e&&t(K.isEmailValid({isValid:!1})),i&&!n&&t(K.isPasswordValid({isValid:!1}));var h=!1===e?Object(O.jsx)("p",{className:$.a.invalid,children:"Email must contains '@'"}):"",p=!1===n?Object(O.jsx)("p",{className:$.a.invalid,children:"Password have to contains minimum 5 characters."}):"";return Object(O.jsxs)("form",{className:$.a.form,onSubmit:function(o){o.preventDefault(),e&&n&&(t(Y.login()),t(E.toggleForm(!1)))},children:[Object(O.jsxs)("div",{className:$.a["form-input"],children:[Object(O.jsx)("label",{htmlFor:"email",children:"E-mail"}),Object(O.jsx)("input",{type:"email",id:"email",onChange:function(e){t(K.isEmailTouched({isTouched:!0})),d(e.target.value),""!==l&&l.includes("@")&&t(K.isEmailValid({isValid:!0}))},onBlur:function(){t(K.isEmailTouched({isTouched:!0}))}}),h]}),Object(O.jsxs)("div",{className:$.a["form-input"],children:[Object(O.jsx)("label",{htmlFor:"password",children:"Password"}),Object(O.jsx)("input",{type:"password",id:"password",onChange:function(e){t(K.isPasswordTouched({isTouched:!0})),f(e.target.value),b.length>=5&&t(K.isPasswordValid({isValid:!0}))},onBlur:function(){t(K.isPasswordTouched({isTouched:!0}))}}),p]}),Object(O.jsx)("div",{className:$.a["form-controls"],children:Object(O.jsx)(x,{type:"submit",value:"Submit"})})]})},G=n(11),U=n.n(G),X=n(16),q=n.n(X),z=function(){var t=Object(r.b)(),e=Object(r.c)((function(t){return t.cart.totalAmount}));return Object(O.jsxs)("button",{className:q.a.button,onClick:function(){t(E.toggleCart())},children:[Object(O.jsx)("span",{children:"Your Cart"}),Object(O.jsx)("span",{className:q.a.amount,children:e})]})},Q=function(){var t=Object(r.b)(),e=Object(r.c)((function(t){return t.login.isLogged}))?Object(O.jsx)("nav",{className:U.a.nav,children:Object(O.jsxs)("ul",{className:U.a.list,children:[Object(O.jsx)("li",{children:Object(O.jsx)(z,{})}),Object(O.jsx)("li",{children:Object(O.jsx)(x,{value:"Logout",onClick:function(){t(Y.logout())}})})]})}):Object(O.jsx)("nav",{className:U.a.nav,children:Object(O.jsx)("ul",{className:U.a.list,children:Object(O.jsx)("li",{children:Object(O.jsx)(x,{value:"Login",onClick:function(){t(E.toggleForm())}})})})});return Object(O.jsxs)("header",{className:U.a.header,children:[Object(O.jsx)("h1",{children:"BookShop"}),e]})},W=n(13),tt=n.n(W),et=function(t){var e,n=t.children,c=t.type,i=Object(o.useState)(!0),a=Object(s.a)(i,2),r=a[0],u=a[1];return e="error"===c?tt.a.error:"success"===c?tt.a.success:tt.a.info,Object(O.jsx)(o.Fragment,{children:r&&Object(O.jsx)("div",{className:e,onClick:function(){u(!1)},type:c,children:n})})},nt=n(4),ot=n.n(nt),ct=n(9),it=Object(u.b)({name:"books",initialState:{items:[]},reducers:{fetchBooks:function(t,e){t.items=e.payload.items}}}),at=it.actions,rt=it,st=!0,ut=!0;var lt=function(){var t=Object(r.b)(),e=Object(r.c)((function(t){return t.cart})),n=Object(r.c)((function(t){return t.login.isLogged})),c=Object(r.c)((function(t){return t.ui.showForm})),i=Object(r.c)((function(t){return t.ui.showCart})),a=Object(r.c)((function(t){return t.notification}));return Object(o.useEffect)((function(){t(function(){var t=Object(ct.a)(ot.a.mark((function t(e){var n;return ot.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=function(){var t=Object(ct.a)(ot.a.mark((function t(){var n,o;return ot.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://bookshop-80519-default-rtdb.firebaseio.com/books.json");case 2:if((n=t.sent).ok){t.next=5;break}throw new Error("Something went wrong!");case 5:return t.next=7,n.json();case 7:o=t.sent,e(at.fetchBooks({items:o}));case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n();case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[t]),Object(o.useEffect)((function(){t(function(){var t=Object(ct.a)(ot.a.mark((function t(e){var n;return ot.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=function(){var t=Object(ct.a)(ot.a.mark((function t(){var n,o;return ot.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://bookshop-80519-default-rtdb.firebaseio.com/cart.json");case 2:if((n=t.sent).ok){t.next=5;break}throw new Error("Something went wrong!");case 5:return t.next=7,n.json();case 7:o=t.sent,e(d.fetchItems({items:o.items||[],totalAmount:o.totalAmount||0,totalPrice:o.totalPrice||0}));case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n();case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}),[t]),Object(o.useEffect)((function(){t(function(t){return function(){var e=Object(ct.a)(ot.a.mark((function e(n){var o;return ot.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=function(){var e=Object(ct.a)(ot.a.mark((function e(){return ot.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://bookshop-80519-default-rtdb.firebaseio.com/cart.json",{method:"PUT",body:JSON.stringify({items:t.items,totalAmount:t.totalAmount,totalPrice:t.totalPrice})});case 2:if(e.sent.ok){e.next=5;break}throw new Error("Something went wrong!");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o().catch((function(t){n(b.showNotification({type:"error",content:"Upss... Try again!"})),setTimeout((function(){n(b.hideNotification())}),2e3)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}(e)),st?st=!1:ut?ut=!1:setTimeout((function(){t(b.hideNotification())}),2e3)}),[e,t]),Object(O.jsxs)(o.Fragment,{children:[i&&Object(O.jsx)(M,{}),Object(O.jsx)(Q,{}),a.showNotification&&Object(O.jsx)(et,{type:a.type,children:a.content}),!n&&Object(O.jsx)(et,{children:"Please login if you want add some products to cart."}),c&&Object(O.jsx)(et,{children:"Do not enter personal data, because it's a demo application!"}),c&&Object(O.jsx)(D,{}),Object(O.jsx)(S,{})]})},dt=Object(u.a)({reducer:{ui:B.reducer,login:J.reducer,validation:Z.reducer,books:rt.reducer,cart:m.reducer,notification:f.reducer}});a.a.render(Object(O.jsx)(r.a,{store:dt,children:Object(O.jsx)(c.a.StrictMode,{children:Object(O.jsx)(lt,{})})}),document.getElementById("root"))}],[[33,1,2]]]);
//# sourceMappingURL=main.e04499ae.chunk.js.map