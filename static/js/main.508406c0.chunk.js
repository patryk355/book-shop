(this["webpackJsonpbook-shop"]=this["webpackJsonpbook-shop"]||[]).push([[0],[,,,,function(t,e,o){t.exports={closeBtn:"Cart_closeBtn__1ICZ_",header:"Cart_header__1VRmx","products-list":"Cart_products-list__OlyJ_",title:"Cart_title__Kwtc3",amount:"Cart_amount__29byP",price:"Cart_price__37oVf",actions:"Cart_actions__c-t0c",totalAmount:"Cart_totalAmount__1f3TY",totalPrice:"Cart_totalPrice__Gm-k2"}},,,,function(t,e,o){t.exports={form:"Form_form__2y-Jr","form-input":"Form_form-input__CRMoT","form-controls":"Form_form-controls__nMuVF",invalid:"Form_invalid__3mKlT"}},function(t,e,o){t.exports={book:"Book_book__3FjtB",details:"Book_details__2xTbb",description:"Book_description__3M4oY","price-container":"Book_price-container__1_zYK",price:"Book_price__38dEK"}},function(t,e,o){t.exports={header:"Header_header__2uZ4G",list:"Header_list__3nnki"}},,function(t,e,o){t.exports={backdrop:"Modal_backdrop__20xkn",modal:"Modal_modal__3grQr",content:"Modal_content__3XRqP"}},function(t,e,o){t.exports={error:"Notification_error__1y0Yx",success:"Notification_success__Zcl8d",info:"Notification_info__3MbSH"}},,,function(t,e,o){t.exports={button:"CartButton_button__3P__5",amount:"CartButton_amount__pA_MC"}},,function(t,e,o){t.exports={button:"Button_button__17Z83"}},function(t,e,o){t.exports={books:"Books_books__AjOCc"}},,,,,function(t,e,o){},,,,,,,,,function(t,e,o){"use strict";o.r(e);var n=o(1),c=o.n(n),i=o(6),a=o.n(i),r=(o(24),o(7)),s=o.n(r),l=o(11),u=o(2),d=o(5),m=o(3),j=Object(m.b)({name:"cart",initialState:{items:[],totalAmount:0,totalPrice:0},reducers:{setTotalAmountAndPrice:function(t){var e=0,o=0;t.items.forEach((function(t){e+=t.amount,o+=t.amount*t.price})),t.totalAmount=e,t.totalAmount=o},fetchItems:function(t,e){t.items=e.payload.items,0===t.items.length?(t.totalAmount=0,t.totalPrice=0):(t.totalAmount=e.payload.totalAmount,t.totalPrice=e.payload.totalPrice)},addItemToCart:function(t,e){var o=e.payload,n=t.items.find((function(t){return t.id===o.id}));if(t.totalAmount++,t.totalPrice+=e.payload.price,n){var c=t.items.findIndex((function(t){return t.id===o.id}));t.items[c].amount+=1}else t.items.push({id:e.payload.id,title:e.payload.title,author:e.payload.author,price:e.payload.price,amount:e.payload.amount})},removeItemFromCart:function(t,e){var o=e.payload,n=t.items.find((function(t){return t.id===o.id}));if(t.totalAmount--,t.totalPrice-=e.payload.price,n){var c=t.items.findIndex((function(t){return t.id===o.id}));t.items[c].amount-=1,0===t.items[c].amount&&t.items.splice(c,1)}else t.items.push({id:e.payload.id,title:e.payload.title,author:e.payload.author,price:e.payload.price,amount:e.payload.amount})}}}),b=j.actions,f=j,h=Object(m.b)({name:"notification",initialState:{type:"",content:"",showNotification:!1},reducers:{showNotification:function(t,e){t.showNotification=!0,t.type=e.payload.type,t.content=e.payload.content},hideNotification:function(t){t.showNotification=!1,t.type="",t.content=""}}}),p=h.actions,O=h,x=o(18),_=o.n(x),v=o(0),g=function(t){return Object(v.jsx)("button",{type:t.type?t.type:"button",onClick:t.onClick,className:_.a.button,children:t.value})},y=o(12),w=o.n(y),k=function(t){return Object(v.jsx)("div",{className:w.a.backdrop,onClick:t.onClose})},N=function(t){return Object(v.jsx)("div",{className:w.a.modal,children:Object(v.jsx)("div",{className:w.a.content,children:t.children})})},C=document.getElementById("overlays"),P=function(t){return Object(v.jsxs)(n.Fragment,{children:[a.a.createPortal(Object(v.jsx)(k,{onClose:t.onClose}),C),a.a.createPortal(Object(v.jsx)(N,{children:t.children}),C)]})},T=o(9),A=o.n(T),S=function(t){var e=t.id,o=t.title,c=t.author,i=t.description,a=t.price,r=t.image_url,s=Object(u.b)(),l=Object(u.c)((function(t){return t.login.isLogged})),m=Object(n.useState)(!1),j=Object(d.a)(m,2),f=j[0],h=j[1],O=Object(n.useState)(!1),x=Object(d.a)(O,2),_=x[0],y=x[1];return Object(v.jsxs)(n.Fragment,{children:[!l&&_&&Object(v.jsx)(P,{children:"You need to login."}),Object(v.jsxs)("li",{className:A.a.book,children:[Object(v.jsx)("h2",{children:o}),Object(v.jsx)("h3",{children:c}),Object(v.jsxs)("div",{className:A.a.details,children:[Object(v.jsxs)("p",{className:A.a.description,children:[f?i:i.substr(0,100)+"...",Object(v.jsx)("button",{onClick:function(){h((function(t){return!t}))},children:f?"Read Less":"Read More"})]}),Object(v.jsx)("img",{src:r,alt:o})]}),Object(v.jsxs)("div",{className:A.a["price-container"],children:[Object(v.jsxs)("p",{className:A.a.price,children:[a,"$"]}),Object(v.jsx)(g,{value:"Add to cart",onClick:function(){l?(s(b.addItemToCart({id:e,title:o,author:c,price:a,amount:1})),s(p.showNotification({type:"success",content:"Successfully added book to cart!"}))):(y(!0),setTimeout((function(){y(!1)}),1e3))}})]})]})]})},F=o(19),E=o.n(F),B=function(){var t=Object(u.c)((function(t){return t.books.items}));return Object(v.jsx)("section",{className:E.a.books,children:Object(v.jsx)("ul",{children:t.map((function(t){var e=t.id,o=t.title,n=t.author,c=t.description,i=t.price,a=t.image_url;return Object(v.jsx)(S,{id:e,title:o,author:n,description:c,price:i,image_url:a},e)}))})})},V=Object(m.b)({name:"ui",initialState:{showForm:!1,showCart:!1},reducers:{toggleForm:function(t){t.showForm=!t.showForm},toggleCart:function(t){t.showCart=!t.showCart}}}),I=V.actions,M=V,L=o(4),Y=o.n(L),J=function(){var t=Object(u.b)(),e=Object(u.c)((function(t){return t.cart})),o=function(){t(I.toggleCart())};return Object(v.jsxs)(P,{onClose:o,children:[Object(v.jsx)("button",{className:Y.a.closeBtn,onClick:o,children:"X"}),Object(v.jsx)("h2",{className:Y.a.header,children:"Your Cart"}),Object(v.jsx)("ul",{className:Y.a["products-list"],children:e.items.map((function(e){var o=e.amount,n=e.author,c=e.id,i=e.price,a=e.title;return Object(v.jsxs)("li",{children:[Object(v.jsx)("h3",{className:Y.a.title,children:a}),Object(v.jsxs)("div",{children:[Object(v.jsxs)("p",{className:Y.a.price,children:[o*i,"$"]}),Object(v.jsxs)("div",{className:Y.a.amount,children:[Object(v.jsx)("button",{className:Y.a.actions,onClick:function(){return function(e,o,n,c,i){t(b.removeItemFromCart({id:e,title:o,author:n,price:c,amount:i})),t(p.showNotification({type:"success",content:"Successfully removed book from cart!"}))}(c,a,n,i,o)},children:"-"}),Object(v.jsx)("input",{type:"number",min:"0",value:o,readOnly:!0}),Object(v.jsx)("button",{className:Y.a.actions,onClick:function(){return function(e,o,n,c,i){t(b.addItemToCart({id:e,title:o,author:n,price:c,amount:i})),t(p.showNotification({type:"success",content:"Successfully added book to cart!"}))}(c,a,n,i,o)},children:"+"})]})]})]},c)}))}),Object(v.jsxs)("h3",{className:Y.a.totalAmount,children:["Total Amount: ",e.totalAmount]}),Object(v.jsxs)("h3",{className:Y.a.totalPrice,children:["Total Price: ",e.totalPrice," $"]})]})},R=Object(m.b)({name:"login",initialState:{isLogged:!1},reducers:{login:function(t){t.isLogged=!0},logout:function(t){t.isLogged=!1}}}),K=R.actions,Z=R,H=Object(m.b)({name:"validation",initialState:{validEmail:null,validPassword:null,emailTouched:!1,passwordTouched:!1},reducers:{isEmailValid:function(t,e){t.validEmail=e.payload.isValid},isPasswordValid:function(t,e){t.validPassword=e.payload.isValid},isEmailTouched:function(t,e){t.emailTouched=e.payload.isTouched},isPasswordTouched:function(t,e){t.passwordTouched=e.payload.isTouched}}}),$=H.actions,D=H,G=o(8),U=o.n(G),X=function(){var t=Object(u.b)(),e=Object(u.c)((function(t){return t.validation.validEmail})),o=Object(u.c)((function(t){return t.validation.validPassword})),c=Object(u.c)((function(t){return t.validation.emailTouched})),i=Object(u.c)((function(t){return t.validation.passwordTouched})),a=(Object(u.c)((function(t){return t.ui.showForm})),Object(n.useState)("")),r=Object(d.a)(a,2),s=r[0],l=r[1],m=Object(n.useState)(""),j=Object(d.a)(m,2),b=j[0],f=j[1];c&&!e&&t($.isEmailValid({isValid:!1})),i&&!o&&t($.isPasswordValid({isValid:!1}));var h=!1===e?Object(v.jsx)("p",{className:U.a.invalid,children:"Email must contains '@'"}):"",p=!1===o?Object(v.jsx)("p",{className:U.a.invalid,children:"Password have to contains minimum 5 characters."}):"";return Object(v.jsxs)("form",{className:U.a.form,onSubmit:function(n){n.preventDefault(),e&&o&&(t(K.login()),t(I.toggleForm(!1)))},children:[Object(v.jsxs)("div",{className:U.a["form-input"],children:[Object(v.jsx)("label",{htmlFor:"email",children:"E-mail"}),Object(v.jsx)("input",{type:"email",id:"email",onChange:function(e){t($.isEmailTouched({isTouched:!0})),l(e.target.value),""!==s&&s.includes("@")&&t($.isEmailValid({isValid:!0}))},onBlur:function(){t($.isEmailTouched({isTouched:!0}))}}),h]}),Object(v.jsxs)("div",{className:U.a["form-input"],children:[Object(v.jsx)("label",{htmlFor:"password",children:"Password"}),Object(v.jsx)("input",{type:"password",id:"password",onChange:function(e){t($.isPasswordTouched({isTouched:!0})),f(e.target.value),b.length>=5&&t($.isPasswordValid({isValid:!0}))},onBlur:function(){t($.isPasswordTouched({isTouched:!0}))}}),p]}),Object(v.jsx)("div",{className:U.a["form-controls"],children:Object(v.jsx)(g,{type:"submit",value:"Submit"})})]})},q=o(10),z=o.n(q),Q=o(16),W=o.n(Q),tt=function(){var t=Object(u.b)(),e=Object(u.c)((function(t){return t.cart.totalAmount}));return Object(v.jsxs)("button",{className:W.a.button,onClick:function(){t(I.toggleCart())},children:[Object(v.jsx)("span",{children:"Your Cart"}),Object(v.jsx)("span",{className:W.a.amount,children:e})]})},et=function(){var t=Object(u.b)(),e=Object(u.c)((function(t){return t.login.isLogged}))?Object(v.jsx)("nav",{className:z.a.nav,children:Object(v.jsxs)("ul",{className:z.a.list,children:[Object(v.jsx)("li",{children:Object(v.jsx)(tt,{})}),Object(v.jsx)("li",{children:Object(v.jsx)(g,{value:"Logout",onClick:function(){t(K.logout())}})})]})}):Object(v.jsx)("nav",{className:z.a.nav,children:Object(v.jsx)("ul",{className:z.a.list,children:Object(v.jsx)("li",{children:Object(v.jsx)(g,{value:"Login",onClick:function(){t(I.toggleForm())}})})})});return Object(v.jsxs)("header",{className:z.a.header,children:[Object(v.jsx)("h1",{children:"BookShop"}),e]})},ot=o(13),nt=o.n(ot),ct=function(t){var e,o=t.children,c=t.type,i=Object(n.useState)(!0),a=Object(d.a)(i,2),r=a[0],s=a[1];return e="error"===c?nt.a.error:"success"===c?nt.a.success:nt.a.info,Object(v.jsx)(n.Fragment,{children:r&&Object(v.jsx)("div",{className:e,onClick:function(){s(!1)},type:c,children:o})})},it=Object(m.b)({name:"books",initialState:{items:[]},reducers:{fetchBooks:function(t,e){t.items=e.payload.items}}}),at=it.actions,rt=it,st=!0,lt=!0;var ut=function(){var t=Object(u.b)(),e=Object(u.c)((function(t){return t.cart})),o=Object(u.c)((function(t){return t.login.isLogged})),c=Object(u.c)((function(t){return t.ui.showForm})),i=Object(u.c)((function(t){return t.ui.showCart})),a=Object(u.c)((function(t){return t.notification}));return Object(n.useEffect)((function(){var e=function(){var e=Object(l.a)(s.a.mark((function e(){var o,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://bookshop-80519-default-rtdb.firebaseio.com/books.json");case 2:if((o=e.sent).ok){e.next=5;break}throw new Error("Something went wrong!");case 5:return e.next=7,o.json();case 7:n=e.sent,t(at.fetchBooks({items:n}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t]),Object(n.useEffect)((function(){var e=function(){var e=Object(l.a)(s.a.mark((function e(){var o,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://bookshop-80519-default-rtdb.firebaseio.com/cart.json");case 2:if((o=e.sent).ok){e.next=5;break}throw new Error("Something went wrong!");case 5:return e.next=7,o.json();case 7:n=e.sent,t(b.fetchItems({items:n.items||[],totalAmount:n.totalAmount||0,totalPrice:n.totalPrice||0}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t]),Object(n.useEffect)((function(){var o=function(){var t=Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://bookshop-80519-default-rtdb.firebaseio.com/cart.json",{method:"PUT",body:JSON.stringify({items:e.items,totalAmount:e.totalAmount,totalPrice:e.totalPrice})});case 2:if(t.sent.ok){t.next=5;break}throw new Error("Something went wrong!");case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();o().catch((function(e){t(p.showNotification({type:"error",content:"Upss... Try again!"})),setTimeout((function(){t(p.hideNotification())}),2e3)})),st?st=!1:lt?lt=!1:setTimeout((function(){t(p.hideNotification())}),2e3)}),[e,t]),Object(v.jsxs)(n.Fragment,{children:[i&&Object(v.jsx)(J,{}),Object(v.jsx)(et,{}),a.showNotification&&Object(v.jsx)(ct,{type:a.type,children:a.content}),!o&&Object(v.jsx)(ct,{children:"Please login if you want add some products to cart."}),c&&Object(v.jsx)(ct,{children:"Do not enter personal data, because it's a demo application!"}),c&&Object(v.jsx)(X,{}),Object(v.jsx)(B,{})]})},dt=Object(m.a)({reducer:{ui:M.reducer,login:Z.reducer,validation:D.reducer,books:rt.reducer,cart:f.reducer,notification:O.reducer}});a.a.render(Object(v.jsx)(u.a,{store:dt,children:Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(ut,{})})}),document.getElementById("root"))}],[[33,1,2]]]);
//# sourceMappingURL=main.508406c0.chunk.js.map