(this["webpackJsonpbook-shop"]=this["webpackJsonpbook-shop"]||[]).push([[0],[,,,,function(t,e,n){t.exports={closeBtn:"Cart_closeBtn__1ICZ_",header:"Cart_header__1VRmx","products-list":"Cart_products-list__OlyJ_",title:"Cart_title__Kwtc3",amount:"Cart_amount__29byP",price:"Cart_price__37oVf",actions:"Cart_actions__c-t0c",totalAmount:"Cart_totalAmount__1f3TY",totalPrice:"Cart_totalPrice__Gm-k2"}},,,,function(t,e,n){t.exports={form:"Form_form__2y-Jr","form-input":"Form_form-input__CRMoT","form-controls":"Form_form-controls__nMuVF",invalid:"Form_invalid__3mKlT"}},function(t,e,n){t.exports={book:"Book_book__3FjtB",details:"Book_details__2xTbb",description:"Book_description__3M4oY","price-container":"Book_price-container__1_zYK",price:"Book_price__38dEK"}},function(t,e,n){t.exports={header:"Header_header__2uZ4G",list:"Header_list__3nnki"}},,function(t,e,n){t.exports={backdrop:"Modal_backdrop__20xkn",modal:"Modal_modal__3grQr",content:"Modal_content__3XRqP"}},function(t,e,n){t.exports={error:"Notification_error__1y0Yx",success:"Notification_success__Zcl8d",info:"Notification_info__3MbSH"}},,,function(t,e,n){t.exports={button:"CartButton_button__3P__5",amount:"CartButton_amount__pA_MC"}},,function(t,e,n){t.exports={button:"Button_button__17Z83"}},function(t,e,n){t.exports={books:"Books_books__AjOCc"}},,,,,function(t,e,n){},,,,,,,,,function(t,e,n){"use strict";n.r(e);var o=n(1),i=n.n(o),c=n(6),a=n.n(c),r=(n(24),n(7)),s=n.n(r),l=n(11),u=n(2),d=n(5),j=n(3),m=Object(j.b)({name:"cart",initialState:{items:[],totalAmount:0,totalPrice:0},reducers:{setTotalAmountAndPrice:function(t){var e=0,n=0;t.items.forEach((function(t){e+=t.amount,n+=t.amount*t.price})),t.totalAmount=e,t.totalAmount=n},fetchItems:function(t,e){t.items=e.payload.items,0===t.items.length?(t.totalAmount=0,t.totalPrice=0):(t.totalAmount=e.payload.totalAmount,t.totalPrice=e.payload.totalPrice)},addItemToCart:function(t,e){var n=e.payload,o=t.items.find((function(t){return t.id===n.id}));if(t.totalAmount++,t.totalPrice+=e.payload.price,o){var i=t.items.findIndex((function(t){return t.id===n.id}));t.items[i].amount+=1}else t.items.push({id:e.payload.id,title:e.payload.title,author:e.payload.author,price:e.payload.price,amount:e.payload.amount})},removeItemFromCart:function(t,e){var n=e.payload,o=t.items.find((function(t){return t.id===n.id}));if(t.totalAmount--,t.totalPrice-=e.payload.price,o){var i=t.items.findIndex((function(t){return t.id===n.id}));t.items[i].amount-=1,0===t.items[i].amount&&t.items.splice(i,1)}else t.items.push({id:e.payload.id,title:e.payload.title,author:e.payload.author,price:e.payload.price,amount:e.payload.amount})}}}),b=m.actions,h=m,f=n(18),p=n.n(f),O=n(0),x=function(t){return Object(O.jsx)("button",{type:t.type?t.type:"button",onClick:t.onClick,className:p.a.button,children:t.value})},_=n(12),v=n.n(_),g=function(t){return Object(O.jsx)("div",{className:v.a.backdrop,onClick:t.onClose})},y=function(t){return Object(O.jsx)("div",{className:v.a.modal,children:Object(O.jsx)("div",{className:v.a.content,children:t.children})})},w=document.getElementById("overlays"),k=function(t){return Object(O.jsxs)(o.Fragment,{children:[a.a.createPortal(Object(O.jsx)(g,{onClose:t.onClose}),w),a.a.createPortal(Object(O.jsx)(y,{children:t.children}),w)]})},N=n(9),C=n.n(N),P=function(t){var e=t.id,n=t.title,i=t.author,c=t.description,a=t.price,r=t.image_url,s=Object(u.b)(),l=Object(u.c)((function(t){return t.login.isLogged})),j=Object(o.useState)(!1),m=Object(d.a)(j,2),h=m[0],f=m[1],p=Object(o.useState)(!1),_=Object(d.a)(p,2),v=_[0],g=_[1];return Object(O.jsxs)(o.Fragment,{children:[!l&&v&&Object(O.jsx)(k,{children:"You need to login."}),Object(O.jsxs)("li",{className:C.a.book,children:[Object(O.jsx)("h2",{children:n}),Object(O.jsx)("h3",{children:i}),Object(O.jsxs)("div",{className:C.a.details,children:[Object(O.jsxs)("p",{className:C.a.description,children:[h?c:c.substr(0,100)+"...",Object(O.jsx)("button",{onClick:function(){f((function(t){return!t}))},children:h?"Read Less":"Read More"})]}),Object(O.jsx)("img",{src:r,alt:n})]}),Object(O.jsxs)("div",{className:C.a["price-container"],children:[Object(O.jsxs)("p",{className:C.a.price,children:[a,"$"]}),Object(O.jsx)(x,{value:"Add to cart",onClick:function(){l?s(b.addItemToCart({id:e,title:n,author:i,price:a,amount:1})):(g(!0),setTimeout((function(){g(!1)}),1e3))}})]})]})]})},T=n(19),A=n.n(T),F=function(){var t=Object(u.c)((function(t){return t.books.items}));return Object(O.jsx)("section",{className:A.a.books,children:Object(O.jsx)("ul",{children:t.map((function(t){var e=t.id,n=t.title,o=t.author,i=t.description,c=t.price,a=t.image_url;return Object(O.jsx)(P,{id:e,title:n,author:o,description:i,price:c,image_url:a},e)}))})})},E=Object(j.b)({name:"ui",initialState:{showForm:!1,showCart:!1},reducers:{toggleForm:function(t){t.showForm=!t.showForm},toggleCart:function(t){t.showCart=!t.showCart}}}),S=E.actions,B=E,V=n(4),I=n.n(V),M=function(){var t=Object(u.b)(),e=Object(u.c)((function(t){return t.cart})),n=function(){t(S.toggleCart())};return Object(O.jsxs)(k,{onClose:n,children:[Object(O.jsx)("button",{className:I.a.closeBtn,onClick:n,children:"X"}),Object(O.jsx)("h2",{className:I.a.header,children:"Your Cart"}),Object(O.jsx)("ul",{className:I.a["products-list"],children:e.items.map((function(e){var n=e.amount,o=e.author,i=(e.description,e.id),c=(e.image_url,e.price),a=e.title;return Object(O.jsxs)("li",{children:[Object(O.jsx)("h3",{className:I.a.title,children:a}),Object(O.jsxs)("div",{children:[Object(O.jsxs)("p",{className:I.a.price,children:[n*c,"$"]}),Object(O.jsxs)("div",{className:I.a.amount,children:[Object(O.jsx)("button",{className:I.a.actions,onClick:function(){return t(b.removeItemFromCart({id:i,title:a,author:o,price:c,amount:n}))},children:"-"}),Object(O.jsx)("input",{type:"number",min:"0",value:n,readOnly:!0}),Object(O.jsx)("button",{className:I.a.actions,onClick:function(){return t(b.addItemToCart({id:i,title:a,author:o,price:c,amount:n}))},children:"+"})]})]})]},i)}))}),Object(O.jsxs)("h3",{className:I.a.totalAmount,children:["Total Amount: ",e.totalAmount]}),Object(O.jsxs)("h3",{className:I.a.totalPrice,children:["Total Price: ",e.totalPrice," $"]})]})},L=Object(j.b)({name:"login",initialState:{isLogged:!1},reducers:{login:function(t){t.isLogged=!0},logout:function(t){t.isLogged=!1}}}),Y=L.actions,J=L,R=Object(j.b)({name:"validation",initialState:{validEmail:null,validPassword:null,emailTouched:!1,passwordTouched:!1},reducers:{isEmailValid:function(t,e){t.validEmail=e.payload.isValid},isPasswordValid:function(t,e){t.validPassword=e.payload.isValid},isEmailTouched:function(t,e){t.emailTouched=e.payload.isTouched},isPasswordTouched:function(t,e){t.passwordTouched=e.payload.isTouched}}}),K=R.actions,Z=R,H=n(8),$=n.n(H),D=function(){var t=Object(u.b)(),e=Object(u.c)((function(t){return t.validation.validEmail})),n=Object(u.c)((function(t){return t.validation.validPassword})),i=Object(u.c)((function(t){return t.validation.emailTouched})),c=Object(u.c)((function(t){return t.validation.passwordTouched})),a=(Object(u.c)((function(t){return t.ui.showForm})),Object(o.useState)("")),r=Object(d.a)(a,2),s=r[0],l=r[1],j=Object(o.useState)(""),m=Object(d.a)(j,2),b=m[0],h=m[1];i&&!e&&t(K.isEmailValid({isValid:!1})),c&&!n&&t(K.isPasswordValid({isValid:!1}));var f=!1===e?Object(O.jsx)("p",{className:$.a.invalid,children:"Email must contains '@'"}):"",p=!1===n?Object(O.jsx)("p",{className:$.a.invalid,children:"Password have to contains minimum 5 characters."}):"";return Object(O.jsxs)("form",{className:$.a.form,onSubmit:function(o){o.preventDefault(),e&&n&&(t(Y.login()),t(S.toggleForm(!1)))},children:[Object(O.jsxs)("div",{className:$.a["form-input"],children:[Object(O.jsx)("label",{htmlFor:"email",children:"E-mail"}),Object(O.jsx)("input",{type:"email",id:"email",onChange:function(e){t(K.isEmailTouched({isTouched:!0})),l(e.target.value),""!==s&&s.includes("@")&&t(K.isEmailValid({isValid:!0}))},onBlur:function(){t(K.isEmailTouched({isTouched:!0}))}}),f]}),Object(O.jsxs)("div",{className:$.a["form-input"],children:[Object(O.jsx)("label",{htmlFor:"password",children:"Password"}),Object(O.jsx)("input",{type:"password",id:"password",onChange:function(e){t(K.isPasswordTouched({isTouched:!0})),h(e.target.value),b.length>=5&&t(K.isPasswordValid({isValid:!0}))},onBlur:function(){t(K.isPasswordTouched({isTouched:!0}))}}),p]}),Object(O.jsx)("div",{className:$.a["form-controls"],children:Object(O.jsx)(x,{type:"submit",value:"Submit"})})]})},G=n(10),U=n.n(G),X=n(16),q=n.n(X),z=function(){var t=Object(u.b)(),e=Object(u.c)((function(t){return t.cart.totalAmount}));return Object(O.jsxs)("button",{className:q.a.button,onClick:function(){t(S.toggleCart())},children:[Object(O.jsx)("span",{children:"Your Cart"}),Object(O.jsx)("span",{className:q.a.amount,children:e})]})},Q=function(){var t=Object(u.b)(),e=Object(u.c)((function(t){return t.login.isLogged}))?Object(O.jsx)("nav",{className:U.a.nav,children:Object(O.jsxs)("ul",{className:U.a.list,children:[Object(O.jsx)("li",{children:Object(O.jsx)(z,{})}),Object(O.jsx)("li",{children:Object(O.jsx)(x,{value:"Logout",onClick:function(){t(Y.logout())}})})]})}):Object(O.jsx)("nav",{className:U.a.nav,children:Object(O.jsx)("ul",{className:U.a.list,children:Object(O.jsx)("li",{children:Object(O.jsx)(x,{value:"Login",onClick:function(){t(S.toggleForm())}})})})});return Object(O.jsxs)("header",{className:U.a.header,children:[Object(O.jsx)("h1",{children:"BookShop"}),e]})},W=n(13),tt=n.n(W),et=function(t){var e,n=t.children,i=t.type,c=Object(o.useState)(!0),a=Object(d.a)(c,2),r=a[0],s=a[1];return e="error"===i?tt.a.error:"success"===i?tt.a.success:tt.a.info,Object(O.jsx)(o.Fragment,{children:r&&Object(O.jsx)("div",{className:e,onClick:function(){s(!1)},type:i,children:n})})},nt=Object(j.b)({name:"books",initialState:{items:[]},reducers:{fetchBooks:function(t,e){t.items=e.payload.items}}}),ot=nt.actions,it=nt,ct=Object(j.b)({name:"notification",initialState:{type:"",content:"",showNotification:!1},reducers:{showNotification:function(t,e){t.showNotification=!0,t.type=e.payload.type,t.content=e.payload.content},hideNotification:function(t){t.showNotification=!1,t.type="",t.content=""}}}),at=ct.actions,rt=ct,st=!0;var lt=function(){var t=Object(u.b)(),e=Object(u.c)((function(t){return t.cart})),n=Object(u.c)((function(t){return t.login.isLogged})),i=Object(u.c)((function(t){return t.ui.showForm})),c=Object(u.c)((function(t){return t.ui.showCart})),a=Object(u.c)((function(t){return t.notification}));return Object(o.useEffect)((function(){var e=function(){var e=Object(l.a)(s.a.mark((function e(){var n,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://bookshop-80519-default-rtdb.firebaseio.com/books.json");case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("Something went wrong!");case 5:return e.next=7,n.json();case 7:o=e.sent,t(ot.fetchBooks({items:o}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[t]),Object(o.useEffect)((function(){var e=function(){var e=Object(l.a)(s.a.mark((function e(){var n,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://bookshop-80519-default-rtdb.firebaseio.com/cart.json");case 2:if((n=e.sent).ok){e.next=5;break}throw new Error("Something went wrong!");case 5:return e.next=7,n.json();case 7:o=e.sent,t(b.fetchItems({items:o.items||[],totalAmount:o.totalAmount||0,totalPrice:o.totalPrice||0}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e(),st=!1}),[t]),Object(o.useEffect)((function(){var n=function(){var n=Object(l.a)(s.a.mark((function n(){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch("https://bookshop-80519-default-rtdb.firebaseio.com/cart.json",{method:"PUT",body:JSON.stringify({items:e.items,totalAmount:e.totalAmount,totalPrice:e.totalPrice})});case 2:if(n.sent.ok){n.next=7;break}throw t(at.showNotification({type:"error",content:"Upss... Try again!"})),setTimeout((function(){t(at.hideNotification())}),2e3),new Error("Something went wrong!");case 7:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();n(),st||(t(at.showNotification({type:"success",content:"Successfully added book to cart!"})),setTimeout((function(){t(at.hideNotification())}),2e3)),st=!1}),[e,t]),Object(O.jsxs)(o.Fragment,{children:[c&&Object(O.jsx)(M,{}),Object(O.jsx)(Q,{}),!st&&a.showNotification&&Object(O.jsx)(et,{type:a.type,children:a.content}),!n&&Object(O.jsx)(et,{children:"Please login if you want add some products to cart."}),i&&Object(O.jsx)(et,{children:"Do not enter personal data, because it's a demo application!"}),i&&Object(O.jsx)(D,{}),Object(O.jsx)(F,{})]})},ut=Object(j.a)({reducer:{ui:B.reducer,login:J.reducer,validation:Z.reducer,books:it.reducer,cart:h.reducer,notification:rt.reducer}});a.a.render(Object(O.jsx)(u.a,{store:ut,children:Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(lt,{})})}),document.getElementById("root"))}],[[33,1,2]]]);
//# sourceMappingURL=main.2c9e1e1d.chunk.js.map